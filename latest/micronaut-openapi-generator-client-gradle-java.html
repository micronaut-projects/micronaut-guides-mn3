<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1'/>
    <title>Use OpenAPI Definition to Generate a Micronaut Client</title>
    <link rel='stylesheet' id='wp-block-library-css' href='https://micronaut.io/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all'/>
    <link rel='stylesheet' id='fonts-fira-sans-css' href='https://fonts.googleapis.com/css2?family=Fira+Sans%3Awght%40300%3B500&#038;display=swap&#038;ver=5.7' type='text/css' media='all'/>
    <link rel='stylesheet' id='micronaut-style-css' href='https://micronaut.io/wp-content/themes/micronaut/style.min.css' type='text/css' media='all'/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="icon" href="https://micronaut.io/wp-content/uploads/2021/02/favicon.ico" type="image/png">
    <link rel="shortcut icon" href="https://micronaut.io/wp-content/uploads/2021/02/favicon.ico" type="image/png">
    <link href="coderay.css" rel="stylesheet" />
    <link href="guide.css" rel="stylesheet" />
    <script src="guide.js"></script>
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:image" content="https://guides.micronaut.io/latest/images/cards/micronaut-openapi-generator-client.png"/>
    <meta name="twitter:creator" content="@micronautfw"/>
    <meta name="twitter:site" content="@micronautfw"/>
    <meta name="twitter:title" content="Use OpenAPI Definition to Generate a Micronaut Client"/>
    <meta name="twitter:description" content="Learn how to generate a Declarative Micronaut Client API from an OpenAPI definition and how to use it in your application"/>
</head>
<body class="page-template page-template-page-sidebar page-template-page-sidebar-php page page-parent guide">

<header id="header">

    <div class="container">

        <nav class="navbar navbar-expand-lg navbar-dark">

            <button class="collapsed" type="button" data-toggle="collapse" data-target="#nav" aria-expanded="false">
                <span></span>
            </button>

            <a class="navbar-brand" href="https://micronaut.io">
                <img src="https://micronaut.io/wp-content/uploads/2020/11/MIcronautLogo_Horizontal.svg" alt="Micronaut framework"/>
            </a>

            <div class="collapse navbar-collapse" id="nav">

                <ul class="navbar-nav ml-auto">

                    <li id="menu-item-2865" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2865 nav-item">
                        <a href="https://micronaut.io/download/" class="nav-link">Download</a>
                    </li>
                    <li id="menu-item-2868" class="menu-item menu-item-type-post_type menu-item-object-page current-menu-item page_item page-item-22 current_page_item current-menu-ancestor current-menu-parent current_page_parent current_page_ancestor menu-item-has-children menu-item-2872 active dropdown nav-item">
                        <a href="./index.html" class="nav-link dropdown-toggle" data-toggle="dropdown">Learn</a>
                        <ul class="dropdown-menu">
                            <li id="menu-item-2869" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2869">
                                <a href="https://micronaut.io/docs/" class="dropdown-item">User Documentation</a>
                            </li>
                            <li id="menu-item-2870" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2870">
                                <a href="./index.html" class="dropdown-item">Guides</a>
                            </li>
                            <li id="menu-item-2896" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2896">
                                <a href="https://micronaut.io/category/microcast/" class="dropdown-item">Microcasts</a>
                            </li>
                            <li id="menu-item-2897" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2897">
                                <a href="https://micronaut.io/category/webinar/" class="dropdown-item">Webinars</a>
                            </li>
                            <li id="menu-item-2871" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2871">
                                <a href="https://micronaut.io/professional-training/" class="dropdown-item">Professional Training</a>
                            </li>
                        </ul>
                    </li>
                    <li id="menu-item-2878" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-2878 dropdown nav-item">
                        <a href="https://micronaut.io/blog/" class="nav-link dropdown-toggle" data-toggle="dropdown">Resources</a>
                        <ul class="dropdown-menu">
                            <li id="menu-item-2879" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2879">
                                <a href="https://micronaut.io/blog/" class="dropdown-item">Blog</a>
                            </li>
                            <li id="menu-item-2881" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2881">
                                <a href="https://micronaut.io/events/" class="dropdown-item">Upcoming Events</a>
                            </li>
                            <li id="menu-item-2880" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2880">
                                <a href="https://micronaut.io/commercial-support/" class="dropdown-item">Commercial Support</a>
                            </li>
                            <li id="menu-item-2882" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2882">
                                <a href="https://micronaut.io/faq/" class="dropdown-item">FAQ</a>
                            </li>
                            <li id="menu-item-2883" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2883">
                                <a href="https://micronaut.io/contact/" class="dropdown-item">Contact</a>
                            </li>
                        </ul>
                    </li>
                    <li id="menu-item-2872" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-2878 dropdown nav-item">
                        <a href="https://micronaut.io/foundation/" aria-current="page" class="nav-link dropdown-toggle" data-toggle="dropdown">Foundation</a>
                        <ul class="dropdown-menu">
                            <li id="menu-item-2877" class="menu-item menu-item-type-post_type menu-item-object-page current-menu-item page_item page-item-22 current_page_item menu-item-2877 active">
                                <a href="https://micronaut.io/foundation/" aria-current="page" class="dropdown-item">Overview</a>
                            </li>
                            <li id="menu-item-2874" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2874">
                                <a href="https://micronaut.io/foundation/corporate-sponsorship/" class="dropdown-item">Corporate Sponsorship</a>
                            </li>
                            <li id="menu-item-2873" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2873">
                                <a href="https://micronaut.io/foundation/community-sponsorship/" class="dropdown-item">Community Sponsorship</a>
                            </li>
                            <li id="menu-item-2876" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2876">
                                <a href="https://micronaut.io/foundation/sponsors/" class="dropdown-item">Sponsors</a>
                            </li>
                        </ul>
                    </li>
                    <li id="menu-item-2884" class="action menu-item menu-item-type-custom menu-item-object-custom menu-item-2884 nav-item">
                        <a target="_blank" rel="noopener" href="https://micronaut.io/launch/" class="nav-link">Launch</a>
                    </li>
                </ul>
            </div>

        </nav>

    </div>
</header>
<div id="breadcrumbs"><div class="container"><a href="https://micronaut.io/">Home</a> » <a href="./index.html">Guides</a> » <a href="micronaut-openapi-generator-client.html">Use OpenAPI Definition to Generate a Micronaut Client</a> » <span class="breadcrumb_last" aria-current="page">gradle | java</span></div></div><!-- .breadcrumbs -->
<main id="main">
    <div class="container">
        <div class="row">
            <div class="col-md-4">

                <div class="toc">
                    <div class="inner">
                        <h1 class="title title_large first-word-bold first-word-break">Table of Contents</h1>
                        <div class="underline"></div>
                        
<ul class="sectlevel1">
<li><a href="#getting-started">1. Getting Started</a></li>
<li><a href="#what-you-will-need">2. What you will need</a></li>
<li><a href="#solution">3. Solution</a></li>
<li><a href="#installing-openapi-generator">4. Installing OpenAPI Generator</a></li>
<li><a href="#generating-the-micronaut-client">5. Generating the Micronaut Client</a></li>
<li><a href="#configure-client-authorization">6. Configure Client Authorization</a>
<ul class="sectlevel2">
<li><a href="#create-twitter-development-account">6.1. Create Twitter Development Account</a></li>
<li><a href="#configure-authorization-for-micronaut-client">6.2. Configure Authorization for Micronaut Client</a></li>
</ul>
</li>
<li><a href="#testing-the-client">7. Testing the Client</a></li>
<li><a href="#using-client-in-a-controller">8. Using Client in a Controller</a>
<ul class="sectlevel2">
<li><a href="#creating-an-introspected-class">8.1. Creating an Introspected Class</a></li>
<li><a href="#implementing-the-controller">8.2. Implementing the Controller</a></li>
</ul>
</li>
<li><a href="#running-the-application">9. Running the Application</a></li>
<li><a href="#generate-a-micronaut-application-native-executable-with-graalvm">10. Generate a Micronaut Application Native Executable with GraalVM</a>
<ul class="sectlevel2">
<li><a href="#native-executable-generation">10.1. Native executable generation</a></li>
</ul>
</li>
<li><a href="#next-steps">11. Next Steps</a>
<ul class="sectlevel2">
<li><a href="#learn-how-to-write-openapi-definition-and-generate-server-based-on-it">11.1. Learn How to Write OpenAPI Definition and Generate Server Based on It</a></li>
<li><a href="#learn-micronaut">11.2. Learn Micronaut</a></li>
<li><a href="#micronaut-openapi">11.3. Micronaut OpenAPI</a></li>
</ul>
</li>
</ul>

                    </div>
                </div>
            </div>
            <div class="col-md-8">
                <h1>Use OpenAPI Definition to Generate a Micronaut Client</h1>
                <div class="underline"></div>
<div class="sect1">
<div class="sectionbody">

<div class="paragraph">
<p>Learn how to generate a Declarative Micronaut Client API from an OpenAPI definition and how to use it in your application</p>
</div>
<div class="paragraph">
<p>Authors: Andriy Dmytruk</p>
</div>
<div class="paragraph">
<p>Micronaut Version: 3.9.2</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="getting-started">1. Getting Started</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://www.openapis.org">OpenAPI</a> is a specification for describing REST APIs. Many web APIs provide definitions for the available endpoints and parameters in form of OpenAPI documents. OpenAPI infrastructure includes numerous tooling, including the OpenAPI generator.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>OpenAPI Generator allows generation of API client libraries (SDK generation), server stubs, documentation and configuration automatically given an OpenAPI Spec (both 2.0 and 3.0 are supported).</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>In this guide, we will use the OpenAPI Generator to generate a client API from an OpenAPI definition file. We will generate the client for <a href="https://developer.twitter.com/en/docs/twitter-api">Twitter API</a>, however the steps
could easily be replicated with any other API with an OpenAPI definition.</p>
</div>
<div class="paragraph">
<p>After generation, we will see how to use the client inside a Micronaut application, including performing API calls in controller methods.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what-you-will-need">2. What you will need</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To complete this guide, you will need the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Some time on your hands</p>
</li>
<li>
<p>A decent text editor or IDE</p>
</li>
<li>
<p>JDK 1.8 or greater installed with <code>JAVA_HOME</code> <a href="https://www.baeldung.com/java-home-on-windows-7-8-10-mac-os-x-linux">configured appropriately</a></p>
</li>
</ul>
</div>
</div>
</div>
</div></div><div class="row"><div class="col-md-12"><div class="sect1">
<h2 id="solution">3. Solution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We recommend that you follow the instructions in the next sections and create the application step by step. However, you can go right to the <strong>completed example</strong>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="micronaut-openapi-generator-client-gradle-java.zip">Download</a> and unzip the source</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="installing-openapi-generator">4. Installing OpenAPI Generator</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To use OpenAPI Generator, we need to <a href="https://github.com/OpenAPITools/openapi-generator#1---installation">install OpenAPI Generator CLI</a>.</p>
</div>
<div class="paragraph">
<p>We will use the jar option. <a href="https://github.com/OpenAPITools/openapi-generator#13---download-jar">Download it</a> and store it in the directory that you want to use for this project.</p>
</div>
<div class="paragraph">
<p>Next, open terminal in the same directory. To verify that generator works correctly run the <code>help</code> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">java -jar openapi-generator-cli-XXX.jar help</code></pre>
</div>
</div>
<div class="paragraph">
<p>It should provide a description and a list of commands.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>All the options for installation are given at the <a href="https://openapi-generator.tech/docs/installation">"CLI Installation" guide on the OpenAPI Generator website</a>.</p>
</div>
<div class="paragraph">
<p>In particular:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>run <code>brew install openapi-generator</code> for Homebrew installation,</p>
</li>
<li>
<p>or read the <a href="https://openapi-generator.tech/docs/installation/#bash-launcher-script">"Bash Launcher Script" section</a>
to set up a bash script with automatic updates</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you installed the generator with a package manager or bash launcher script, simply run</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">openapi-generator-cli help</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You can also use the <a href="https://openapi-generator.tech/docs/online">OpenAPI Generator Online Service</a> but its usage
is not covered by this guide.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="generating-the-micronaut-client">5. Generating the Micronaut Client</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We will generate a client for <a href="https://developer.twitter.com/en/docs/twitter-api">Twitter API</a>.</p>
</div>
<div class="paragraph">
<p>To do this, we will need to download the official Twitter API OpenAPI definition file: <a href="https://api.twitter.com/2/openapi.json">https://api.twitter.com/2/openapi.json</a>.
Save it as <code>twitter-api-definition.json</code> and move into the directory that you intend to use for this project.</p>
</div>
<div class="paragraph">
<p>To generate the Micronaut client from the JSON definition, open the terminal in the directory where the definition file and
the OpenAPI generator executable are located, and run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">java -jar openapi-generator-cli-5.4.0.jar generate \
    -g java-micronaut-client \<i class="conum" data-value="1"></i><b>(1)</b>
    -i twitter-api-definition.json \<i class="conum" data-value="2"></i><b>(2)</b>
    -o ./ \<i class="conum" data-value="3"></i><b>(3)</b>
    -p apiPackage=example.micronaut.api \<i class="conum" data-value="4"></i><b>(4)</b>
    -p modelPackage=example.micronaut.model \<i class="conum" data-value="5"></i><b>(5)</b>
    -p build=gradle \<i class="conum" data-value="6"></i><b>(6)</b>
    -p test=junit<i class="conum" data-value="7"></i><b>(7)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Specify that we will use the Java Micronaut client generator.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Specify our OpenAPI definition file as <code>twitter-api-definition.json</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Specify the output directory to be the current directory (<code>./</code>).
You can specify it to be a different one if you want.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>We provide generator-specific properties starting with <code>-p</code>.
We want all the API files to be generated in the <code>example.twitter.api</code> package.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>We want all the models to be in the <code>example.twitter.model</code> package.
In this package classes for data models, that are used for communication with server will be generated.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>We want to use gradle as build tool. The supported values are <code>gradle</code>, <code>maven</code> and <code>all</code>.
If nothing is specified, both Maven and Gradle files are generated.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>We want to use JUnit 5 for testing. The supported values are <code>junit</code> (JUnit 5) and <code>spock</code>.
If nothing is specified, <code>junit</code> is used by default.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After generation finishes, you should see the following directory structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="text">./
├── docs
│   └── ... <i class="conum" data-value="1"></i><b>(1)</b>
├── src/
│   ├── main/
│   │   ├── java/
│   │   │   └── example/twitter/
│   │   │       ├── api <i class="conum" data-value="2"></i><b>(2)</b>
│   │   │       │   ├── GeneralApi.java
│   │   │       │   ├── SpacesApi.java
│   │   │       │   ├── TweetsApi.java
│   │   │       │   └── UsersApi.java
│   │   │       └── model <i class="conum" data-value="3"></i><b>(3)</b>
│   │   │           ├── ...
│   │   │           ├── Tweet.java
│   │   │           ├── TweetSearchResponse.java
│   │   │           ├── User.java
│   │   │           └── ...
│   │   └── resources/
│   │       ├── application.yml <i class="conum" data-value="4"></i><b>(4)</b>
│   │       └── logback.xml
│   └── test/
│       └── java/
│           └── example/twitter/ <i class="conum" data-value="5"></i><b>(5)</b>
│               ├── api
│               │   ├── GeneralApiTest.java
│               │   ├── SpacesApiTest.java
│               │   ├── TweetsApiTest.java
│               │   └── UsersApiTest.java
│               └── model
│                   └── ...
├── README.md
└── ...</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>docs/</code> directory contains automatically generated Markdown files with documentation about your API.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>example.twitter.api</code> package contains API classes.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>example.twitter.model</code> package contains data classes, that are used in parameters or bodies of both
requests and responses in the API.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The <code>application.yml</code> file contains the configuration of your Micronaut application. We will modify it later.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Templates for tests are generated. Test files for both APIs and models were created.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The definition file is a document describing the Twitter API according to the <a href="https://swagger.io/specification/">OpenAPI Specification</a>.</p>
</div>
<div class="paragraph">
<p>If you want to learn about the structure of OpenAPI specification and how to simplify the creation of a Micronaut Server
with it, read the <a href="https://guides.micronaut.io/latest/micronaut-openapi-generator-server.html">"Use OpenAPI Defintion to Generate a Micronaut Server" guide</a>
or the <a href="https://swagger.io/docs/specification/about/">OpenAPI guide</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As you can see, four API files were generated for the Twitter API.</p>
</div>
<div class="paragraph">
<p>If you look inside the API files, you will see that method definitions were generated corresponding to different
paths and operations available in the API. Using Micronaut`s features, we will be able to inject a client implementation
of this interface and use it by calling the corresponding methods without the need to worry how client-server communication
is handled.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you want to view all the available parameters for micronaut server generator, run</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">java -jar openapi-generator-cli-5.4.0.jar config-help \
-g java-micronaut-client</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configure-client-authorization">6. Configure Client Authorization</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In order to send requests to an API, you might be required to configure Authorization.</p>
</div>
<div class="sect2">
<h3 id="create-twitter-development-account">6.1. Create Twitter Development Account</h3>
<div class="paragraph">
<p>In case of Twitter, we need to configure OAuth2 authorization. You can authorize with an API key
via the OAuth2 authorization code flow or using a Bearer token.</p>
</div>
<div class="paragraph">
<p>We will use the API key option. To get your API key, you will need to sign up for a Twitter developer account.
To do this, follow the first 2 steps on the
<a href="https://developer.twitter.com/en/docs/twitter-api/getting-started/getting-access-to-the-twitter-api">"Getting Access to the Twitter API"</a> guide.
Do not forget to save your <code>API key</code> and <code>API secret</code> values somewhere.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can read about Twitter OAuth2 authentication in the <a href="https://developer.twitter.com/en/docs/authentication/oauth-2-0">"Authorization" page of the Twitter API documentation</a>.
The documentation specifies <a href="https://developer.twitter.com/en/docs/authentication/oauth-2-0/application-only">authentication with Bearer token</a>
and <a href="https://developer.twitter.com/en/docs/authentication/oauth-2-0/bearer-tokens">using an API key</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you forgot to save your <code>API key</code> and <code>API secret</code>, you can get a new pair:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>on the Twitter developer portal, open your project settings,</p>
</li>
<li>
<p>inside project settings, open application settings,</p>
</li>
<li>
<p>find the <code>Keys and tokens</code> tab,</p>
</li>
<li>
<p>inside the tab find the <code>API key and secret</code> section and click <code>Regenerate</code> to retrieve a new pair of keys.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="configure-authorization-for-micronaut-client">6.2. Configure Authorization for Micronaut Client</h3>
<div class="paragraph">
<p>We will modify the <code>application.yml</code> to include the following configuration:</p>
</div>
<div class="listingblock">
<div class="title">src/main/resources/application.yml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">micronaut</span>:
  <span class="key">application</span>:
    <span class="key">name</span>: <span class="string"><span class="content">openapi-micronaut</span></span>
  <span class="key">server</span>:
    <span class="key">port</span>: <span class="string"><span class="content">8080</span></span>
  <span class="key">security</span>:
    <span class="key">oauth2</span>:
      <span class="key">clients</span>:
        <span class="key">twitter</span>: <i class="conum" data-value="1"></i><b>(1)</b>
          <span class="key">client-id</span>: <span class="string"><span class="content">'${TWITTER_AUTH_CLIENT_ID:}' </span></span><i class="conum" data-value="4"></i><b>(4)</b>
          <span class="key">client-secret</span>: <span class="string"><span class="content">'${TWITTER_AUTH_CLIENT_SECRET:}'</span></span>
          <span class="key">client-credentials</span>:
            <span class="key">service-id-regex</span>: <span class="string"><span class="content">'.*'</span></span>
            <span class="key">uri-regex</span>: <span class="string"><span class="content">'api.twitter.com/.*' </span></span><i class="conum" data-value="5"></i><b>(5)</b>
          <span class="key">token</span>:
            <span class="key">url</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">${openapi-micronaut-client-base-path}oauth2/token</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="3"></i><b>(3)</b>
            <span class="key">auth-method</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">client_secret_basic</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We add a value to the <code>miconaut.security.oauth2.clients</code>. We will add it with the key of <code>twitter</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Set the authorization flow to <code>client_secret_basic</code>. This authorization was created for applications that need
to access the resources on behalf of itself and requires an <code>id</code> and a <code>secret</code> parameter, and a token url.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Specify the url for retrieving tokens. We found it in the Twitter documentation.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Specify the <code>client-id</code> and <code>client-secret</code> parameters. You could directly put your id and secret directly as values
in the configuration, however this highly discouraged due to security concerns. We will point to environment variables
instead.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Specify that this authorization should be used for all requests to the Twitter api URL (starting with <code>api.twitter.com</code>). Also, set it to be used for all service ids.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Before running the application we will need to set the values of <code>client-id</code> and <code>client-secret</code> using environment
variables. To do it, paste your <code>API key</code> and <code>API secret</code> into the following command and run in terminal:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">export TWITTER_AUTH_CLIENT_ID=XXXXXXXXXXXXXXXXXXXXXXXXX
export TWITTER_AUTH_CLIENT_SECRET=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</code></pre>
</div>
</div>
<div class="paragraph">
<p>Do not forget to add these lines before running any tests or application. If you are using an IDE, there probably should
be an option to add environment variables in the run settings. View the documentation of your specific IDE for details.</p>
</div>
<div class="paragraph">
<p>Now, the client should authorize correctly, and we will be able to send requests.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="testing-the-client">7. Testing the Client</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can see that four APIs were generated in the project. These APIs have paths logically distributed between them.
You can look at <a href="https://developer.twitter.com/en/docs/twitter-api">Twitter API v2</a> documentation for description on
each of the paths, and notice that the sections are also logically split into <code>Tweets</code>, <code>Users</code> and <code>Spaces</code>, as well.</p>
</div>
<div class="paragraph">
<p>We will show how we can use the Twitter API by writing some simple tests using the generated Micronaut client.
First, we will use the <a href="https://developer.twitter.com/en/docs/twitter-api/tweets/counts/introduction">recent tweet counts API</a>
to get the number of tweets about Toronto in the last 7 days. Open the <code>TweetsApiTest</code> and rewrite the contents of the file with the following:</p>
</div>
<div class="listingblock">
<div class="title">src/test/java/example/twitter/api/TweetsApiTest.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">example.twitter.api</span>;

<span class="keyword">import</span> <span class="include">example.twitter.model.SearchCount</span>;
<span class="keyword">import</span> <span class="include">example.twitter.model.Tweet</span>;
<span class="keyword">import</span> <span class="include">example.twitter.model.TweetCountsResponse</span>;
<span class="keyword">import</span> <span class="include">example.twitter.model.TweetSearchResponse</span>;
<span class="keyword">import</span> <span class="include">example.twitter.model.User</span>;
<span class="keyword">import</span> <span class="include">io.micronaut.test.extensions.junit5.annotation.MicronautTest</span>;
<span class="keyword">import</span> <span class="include">jakarta.inject.Inject</span>;
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.Test</span>;
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.condition.EnabledIfEnvironmentVariable</span>;

<span class="keyword">import</span> <span class="include">java.time.OffsetDateTime</span>;
<span class="keyword">import</span> <span class="include">java.util.Arrays</span>;
<span class="keyword">import</span> <span class="include">java.util.Collections</span>;
<span class="keyword">import</span> <span class="include">java.util.HashSet</span>;
<span class="keyword">import</span> <span class="include">java.util.List</span>;
<span class="keyword">import</span> <span class="include">java.util.Objects</span>;
<span class="keyword">import</span> <span class="include">java.util.Set</span>;
<span class="keyword">import</span> <span class="include">java.util.stream.Collectors</span>;

<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.jupiter.api.Assertions.assertEquals</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.jupiter.api.Assertions.assertNotNull</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.jupiter.api.Assertions.assertTrue</span>;


<span class="comment">/**
 * API tests for TweetsApi
 */</span>
<span class="annotation">@MicronautTest</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span class="annotation">@EnabledIfEnvironmentVariable</span>(named = <span class="string"><span class="delimiter">&quot;</span><span class="content">TWITTER_AUTH_CLIENT_ID</span><span class="delimiter">&quot;</span></span>, matches = <span class="string"><span class="delimiter">&quot;</span><span class="content">.+</span><span class="delimiter">&quot;</span></span>) <i class="conum" data-value="2"></i><b>(2)</b>
<span class="directive">public</span> <span class="type">class</span> <span class="class">TweetsApiTest</span> {

    <span class="annotation">@Inject</span>
    TweetsApi api; <i class="conum" data-value="3"></i><b>(3)</b>

    <span class="comment">/**
     * Recent search counts
     */</span>
    <span class="annotation">@Test</span>
    <span class="directive">public</span> <span class="type">void</span> tweetCountsRecentSearchTest() {
        <span class="comment">// WHEN</span>
        <span class="predefined-type">String</span> query = <span class="string"><span class="delimiter">&quot;</span><span class="content">Toronto</span><span class="delimiter">&quot;</span></span>;
        TweetCountsResponse response = api.tweetCountsRecentSearch(
                query, <span class="predefined-constant">null</span>, <span class="predefined-constant">null</span>, <span class="predefined-constant">null</span>, <span class="predefined-constant">null</span>, <span class="predefined-constant">null</span>, <span class="predefined-constant">null</span>).block(); <i class="conum" data-value="4"></i><b>(4)</b>

        <span class="comment">// THEN</span>
        assertNotNull(response);
        <span class="comment">// Calculate total count</span>
        assertNotNull(response.getData());
        <span class="predefined-type">Integer</span> totalCount = response.getData().stream()
                .filter(Objects::nonNull)
                .map(SearchCount::getTweetCount)
                .reduce(<span class="integer">0</span>, <span class="predefined-type">Integer</span>::sum);
        <span class="comment">// There should be more than 100 tweets with such query in the last 7 days</span>
        assertTrue(totalCount &gt; <span class="integer">100</span>); <i class="conum" data-value="5"></i><b>(5)</b>
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Annotating the class with <code>@MicronautTest</code> will create a Micronaut context and allows utilizing various Micronaut features, like injection. <a href="https://micronaut-projects.github.io/micronaut-test/latest/guide/">More info</a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Enable the test only if Twitter developer credentials are present.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Injection for <code>TweetsApi</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Use the <code>api</code> to send a request to an API path for counting tweets with a specific query. We will count tweets that mentioned <code>"Toronto"</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>We will verify that the data is present. Using manipulations with the generated data models we will calculate the total number of tweets and verify that there are at least <code>100</code> (which reasonably should be always true).</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now, we will test receiving the latest <code>10</code> tweets about New York City (NYC). We will use the
<a href="https://developer.twitter.com/en/docs/twitter-api/tweets/lookup/quick-start">recent tweets lookup API</a>.
To test the data models, we will get multiple properties of the tweet, and also properties of the user
who posted it. We will add the following test to the <code>TwetsApiTest</code> class:</p>
</div>
<div class="listingblock">
<div class="title">src/test/java/example/twitter/api/TweetsApiTest.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="comment">/**
     * Recent search
     */</span>
    <span class="annotation">@Test</span>
    <span class="directive">public</span> <span class="type">void</span> tweetsRecentSearchTest() {
        <span class="comment">// GIVEN</span>
        <span class="predefined-type">String</span> query = <span class="string"><span class="delimiter">&quot;</span><span class="content">nyc</span><span class="delimiter">&quot;</span></span>; <i class="conum" data-value="1"></i><b>(1)</b>
        OffsetDateTime startTime = <span class="predefined-constant">null</span>;
        OffsetDateTime endTime = <span class="predefined-constant">null</span>;
        <span class="predefined-type">String</span> sinceId = <span class="predefined-constant">null</span>;
        <span class="predefined-type">String</span> untilId = <span class="predefined-constant">null</span>;
        <span class="predefined-type">Integer</span> maxResults = <span class="integer">10</span>;
        <span class="predefined-type">String</span> nextToken = <span class="predefined-constant">null</span>;
        <span class="predefined-type">Set</span>&lt;<span class="predefined-type">String</span>&gt; expansions = <span class="keyword">new</span> <span class="predefined-type">HashSet</span>&lt;&gt;(<span class="predefined-type">Collections</span>.singletonList(<span class="string"><span class="delimiter">&quot;</span><span class="content">author_id</span><span class="delimiter">&quot;</span></span>)); <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="predefined-type">Set</span>&lt;<span class="predefined-type">String</span>&gt; tweetFields = <span class="keyword">new</span> <span class="predefined-type">HashSet</span>&lt;&gt;(<span class="predefined-type">Arrays</span>.asList( <i class="conum" data-value="3"></i><b>(3)</b>
                <span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">author_id</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">created_at</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">attachments</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">lang</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">possibly_sensitive</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">text</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">source</span><span class="delimiter">&quot;</span></span>
        ));
        <span class="predefined-type">Set</span>&lt;<span class="predefined-type">String</span>&gt; userFields = <span class="keyword">new</span> <span class="predefined-type">HashSet</span>&lt;&gt;(<span class="predefined-type">Arrays</span>.asList(<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">created_at</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">username</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>)); <i class="conum" data-value="4"></i><b>(4)</b>
        <span class="predefined-type">Set</span>&lt;<span class="predefined-type">String</span>&gt; mediaFields = <span class="predefined-constant">null</span>;
        <span class="predefined-type">Set</span>&lt;<span class="predefined-type">String</span>&gt; placeFields = <span class="predefined-constant">null</span>;
        <span class="predefined-type">Set</span>&lt;<span class="predefined-type">String</span>&gt; pollFields = <span class="predefined-constant">null</span>;

        <span class="comment">// WHEN</span>
        TweetSearchResponse response = api.tweetsRecentSearch(
                query, startTime, endTime, sinceId, untilId, maxResults, nextToken, expansions, tweetFields,
                userFields, mediaFields, placeFields, pollFields).block(); <i class="conum" data-value="5"></i><b>(5)</b>

        <span class="comment">// THEN</span>
        assertNotNull(response);

        <span class="comment">// Tweets should be present</span>
        <span class="predefined-type">List</span>&lt;Tweet&gt; tweets = response.getData(); <i class="conum" data-value="6"></i><b>(6)</b>
        assertNotNull(tweets);
        assertEquals(maxResults, tweets.size());

        Tweet tweet = tweets.get(<span class="integer">0</span>);
        assertNotNull(tweet);
        assertNotNull(tweet.getAuthorId());
        assertNotNull(tweet.getCreatedAt());
        assertNotNull(tweet.getLang());
        assertNotNull(tweet.getPossiblySensitive());
        assertNotNull(tweet.getText());

        <span class="comment">// Users should be present</span>
        assertNotNull(response.getIncludes());
        <span class="predefined-type">List</span>&lt;User&gt; users = response.getIncludes().getUsers(); <i class="conum" data-value="7"></i><b>(7)</b>
        assertNotNull(users);
        assertTrue(users.size() &gt; <span class="integer">0</span>);

        User user = users.get(<span class="integer">0</span>);
        assertNotNull(user);
        assertNotNull(user.getId());
        assertNotNull(user.getUsername());
    }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Set the search query to <code>"nyc"</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Expand the query on the <code>author_id</code> property to additionally get information about the user based on their id.
You can read about expanding in the <a href="https://developer.twitter.com/en/docs/twitter-api/expansions">Twitter API expansions documentation page</a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Specify the fields we want to get for each tweet.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Specify the fields we want to get for users (authors of tweets).</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Retrieve the response from server.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Get all the tweets from the response and verify that some common properties are present.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Get users form a separate property of the response and verify that the information is present.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Finally, we will test getting multiple pages using the same
<a href="https://developer.twitter.com/en/docs/twitter-api/tweets/lookup/quick-start">recent tweets lookup API</a>:</p>
</div>
<div class="listingblock">
<div class="title">src/test/java/example/twitter/api/TweetsApiTest.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="comment">/**
     * Recent search with the nextToken parameter set (to retrieve batch)
     */</span>
    <span class="annotation">@Test</span>
    <span class="directive">public</span> <span class="type">void</span> tweetsRecentSearchTestNextToken() {
        <span class="comment">// WHEN</span>
        <span class="predefined-type">String</span> query = <span class="string"><span class="delimiter">&quot;</span><span class="content">Toronto</span><span class="delimiter">&quot;</span></span>;
        <span class="type">int</span> maxResults = <span class="integer">10</span>;
        TweetSearchResponse response = api.tweetsRecentSearch(query, <span class="predefined-constant">null</span>, <span class="predefined-constant">null</span>, <span class="predefined-constant">null</span>,
                <span class="predefined-constant">null</span>, maxResults, <span class="predefined-constant">null</span>, <span class="predefined-constant">null</span>, <span class="predefined-constant">null</span>, <span class="predefined-constant">null</span>, <span class="predefined-constant">null</span>, <span class="predefined-constant">null</span>, <span class="predefined-constant">null</span>).block(); <i class="conum" data-value="1"></i><b>(1)</b>

        <span class="comment">// THEN</span>
        assertNotNull(response);
        assertNotNull(response.getData());
        assertEquals(maxResults, response.getData().size());
        <span class="predefined-type">Set</span>&lt;<span class="predefined-type">String</span>&gt; tweetIds = response.getData().stream().map(Tweet::getId).collect(Collectors.toSet());

        assertNotNull(response.getMeta());
        <span class="predefined-type">String</span> nextToken = response.getMeta().getNextToken();
        assertNotNull(nextToken);

        <span class="comment">// WHEN</span>
        TweetSearchResponse nextResponse = api.tweetsRecentSearch(query, <span class="predefined-constant">null</span>, <span class="predefined-constant">null</span>, <span class="predefined-constant">null</span>,
                <span class="predefined-constant">null</span>, maxResults, nextToken, <span class="predefined-constant">null</span>, <span class="predefined-constant">null</span>, <span class="predefined-constant">null</span>, <span class="predefined-constant">null</span>,
                <span class="predefined-constant">null</span>, <span class="predefined-constant">null</span>).block(); <i class="conum" data-value="2"></i><b>(2)</b>

        <span class="comment">// THEN</span>
        assertNotNull(nextResponse);
        assertNotNull(nextResponse.getData());
        assertEquals(maxResults, nextResponse.getData().size());
        <span class="comment">// Calculate the intersection and verify that no match</span>
        <span class="predefined-type">Set</span>&lt;<span class="predefined-type">String</span>&gt; nextTweetIds = nextResponse.getData().stream().map(Tweet::getId).collect(Collectors.toSet());
        nextTweetIds.retainAll(tweetIds);
        assertTrue(nextTweetIds.isEmpty()); <i class="conum" data-value="3"></i><b>(3)</b>
    }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Retrieve the first <code>10</code> tweets that match our query.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Retrieve the next <code>10</code> tweets that match the query using the <code>nextToken</code> parameter.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Verify that the no tweets on the two pages match.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We will now proceed to use the API in a simple application. However, you would probably want to also implement
tests for all other paths of the API, if you were planning to use them in your application.</p>
</div>
<div class="paragraph">
<p>To run the tests:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">./gradlew test</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then open <code>build/reports/tests/test/index.html</code> in a browser to see the results.</p>
</div>
<div class="paragraph">
<p>All the tests should run successfully.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-client-in-a-controller">8. Using Client in a Controller</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We will now write a controller, that will search for most frequent words in the latest tweets on
a given topic.</p>
</div>
<div class="sect2">
<h3 id="creating-an-introspected-class">8.1. Creating an Introspected Class</h3>
<div class="paragraph">
<p>We will first define an object to represent the response. Create a file for <code>WordFrequency</code> class, that will have the word
itself, and the number it occurred as properties:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/example/micronaut/model/WordFrequency.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">example.micronaut.model</span>;

<span class="keyword">import</span> <span class="include">io.micronaut.core.annotation.Introspected</span>;
<span class="keyword">import</span> <span class="include">io.micronaut.core.annotation.NonNull</span>;
<span class="keyword">import</span> <span class="include">javax.validation.constraints.NotBlank</span>;
<span class="keyword">import</span> <span class="include">javax.validation.constraints.NotNull</span>;

<span class="annotation">@Introspected</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span class="directive">public</span> <span class="type">class</span> <span class="class">WordFrequency</span> {
    <span class="annotation">@NonNull</span> <span class="annotation">@NotBlank</span>
    <span class="directive">private</span> <span class="directive">final</span> <span class="predefined-type">String</span> word;
    <span class="annotation">@NonNull</span> <span class="annotation">@NotNull</span>
    <span class="directive">private</span> <span class="directive">final</span> <span class="predefined-type">Integer</span> numberOccurred; <i class="conum" data-value="2"></i><b>(2)</b>

    <span class="directive">public</span> WordFrequency(<span class="annotation">@NonNull</span> <span class="predefined-type">String</span> word, <span class="annotation">@NonNull</span> <span class="predefined-type">Integer</span> numberOccurred) {
        <span class="local-variable">this</span>.word = word;
        <span class="local-variable">this</span>.numberOccurred = numberOccurred;
    }

    <span class="annotation">@NonNull</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> getWord() {
        <span class="keyword">return</span> word;
    }

    <span class="annotation">@NonNull</span>
    <span class="directive">public</span> <span class="predefined-type">Integer</span> getNumberOccurred() {
        <span class="keyword">return</span> numberOccurred;
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Annotate the class with <a href="https://docs.micronaut.io/latest/api/io/micronaut/core/annotation/Introspected.html"><code>@Introspected</code></a> to generate <code>BeanIntrospection</code> metadata at compilation time. This information can be used, for example, to render the POJO as JSON using Jackson without using reflection.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Define the two required properties and create getters for them.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="implementing-the-controller">8.2. Implementing the Controller</h3>
<div class="paragraph">
<p>We will create the API of the controller. It will use the generated <code>TweetApi</code> client, and the <code>WordFrequency</code>
class, which we just created.
Create a file for <code>TwitterFrequentWordsController</code> class and paste the following:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/example/micronaut/controller/TwitterFrequentWordsController.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">example.micronaut.controller</span>;

<span class="keyword">import</span> <span class="include">example.twitter.api.TweetsApi</span>;
<span class="keyword">import</span> <span class="include">example.twitter.model.TweetSearchResponse</span>;
<span class="keyword">import</span> <span class="include">example.micronaut.model.WordFrequency</span>;
<span class="keyword">import</span> <span class="include">io.micronaut.core.annotation.NonNull</span>;
<span class="keyword">import</span> <span class="include">io.micronaut.http.annotation.Controller</span>;
<span class="keyword">import</span> <span class="include">io.micronaut.http.annotation.Get</span>;
<span class="keyword">import</span> <span class="include">io.micronaut.http.annotation.QueryValue</span>;
<span class="keyword">import</span> <span class="include">io.micronaut.security.annotation.Secured</span>;
<span class="keyword">import</span> <span class="include">io.micronaut.security.rules.SecurityRule</span>;
<span class="keyword">import</span> <span class="include">reactor.core.publisher.Flux</span>;

<span class="keyword">import</span> <span class="include">java.util.Arrays</span>;
<span class="keyword">import</span> <span class="include">java.util.Collections</span>;
<span class="keyword">import</span> <span class="include">java.util.HashMap</span>;
<span class="keyword">import</span> <span class="include">java.util.List</span>;
<span class="keyword">import</span> <span class="include">java.util.Map</span>;
<span class="keyword">import</span> <span class="include">java.util.stream.Collectors</span>;

<span class="annotation">@Controller</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/twitter-frequent-words</span><span class="delimiter">&quot;</span></span>) <i class="conum" data-value="1"></i><b>(1)</b>
<span class="directive">public</span> <span class="type">class</span> <span class="class">TwitterFrequentWordsController</span> {

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">int</span> TWEETS_NUMBER = <span class="integer">50</span>;

    <span class="directive">private</span> <span class="directive">final</span> TweetsApi tweetsApi;

    <span class="directive">public</span> TwitterFrequentWordsController(TweetsApi tweetsApi) { <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="local-variable">this</span>.tweetsApi = tweetsApi;
    }

    <span class="annotation">@Get</span> <i class="conum" data-value="3"></i><b>(3)</b>
    <span class="annotation">@Secured</span>(SecurityRule.IS_ANONYMOUS)
    <span class="directive">public</span> Flux&lt;WordFrequency&gt; get(<span class="annotation">@QueryValue</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">search-query</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">String</span> searchQuery,
                                   <span class="annotation">@QueryValue</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">words-n</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">Integer</span> wordsNumber <i class="conum" data-value="4"></i><b>(4)</b>
    ) {
        <span class="keyword">return</span> tweetsApi.tweetsRecentSearch(searchQuery,
                <span class="predefined-constant">null</span>, <span class="predefined-constant">null</span>, <span class="predefined-constant">null</span>, <span class="predefined-constant">null</span>, TWEETS_NUMBER, <span class="predefined-constant">null</span>, <span class="predefined-constant">null</span>,
                <span class="predefined-constant">null</span>, <span class="predefined-constant">null</span>, <span class="predefined-constant">null</span>, <span class="predefined-constant">null</span>, <span class="predefined-constant">null</span>)
                .flatMapIterable(v -&gt; getTopFrequentWords(v, wordsNumber)); <i class="conum" data-value="5"></i><b>(5)</b>
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The class is defined as a controller with the <a href="https://docs.micronaut.io/latest/api/io/micronaut/http/annotation/Controller.html">@Controller</a> annotation mapped to the path <code>/twitter-frequent-words</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Injection for <code>TweetsApi</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <a href="https://docs.micronaut.io/latest/api/io/micronaut/http/annotation/Get.html">@Get</a> annotation maps the <code>get</code> method to an HTTP GET request on <code>/twitter-frequent-words</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Use the <a href="https://docs.micronaut.io/latest/api/io/micronaut/http/annotation/QueryValue.html">@QueryValue</a> annotation to define the <code>search-query</code> and <code>words-n</code> parameters to be provided in the query part of the URL. Micronaut will parse them from request and provide as arguments to the method.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Make a request to the Twitter api and process the data using a function that we will implement next.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now add the method responsible for processing the data to the controller. There is no need to get into the details of its
implementation, but we will leave some description for a curious reader:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/example/micronaut/controller/TwitterFrequentWordsController.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="annotation">@NonNull</span>
    <span class="directive">private</span> <span class="directive">static</span> <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Integer</span>&gt; getWordOccurrences(<span class="annotation">@NonNull</span> TweetSearchResponse response) { <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Integer</span>&gt; wordOccurrences = <span class="keyword">new</span> <span class="predefined-type">HashMap</span>&lt;&gt;(); <i class="conum" data-value="2"></i><b>(2)</b>

        response.getData().forEach(tweet -&gt;
                <span class="predefined-type">Arrays</span>.stream(tweet.getText().split(<span class="string"><span class="delimiter">&quot;</span><span class="content">[^a-zA-Z]+</span><span class="delimiter">&quot;</span></span>))
                        .map(<span class="predefined-type">String</span>::toLowerCase)
                        .filter(w -&gt; w.length() &gt; <span class="integer">3</span>)
                        .forEach(word -&gt; wordOccurrences.put(word, wordOccurrences.getOrDefault(word, <span class="integer">0</span>) + <span class="integer">1</span>)) <i class="conum" data-value="3"></i><b>(3)</b>
        );

        <span class="keyword">return</span> wordOccurrences;
    }

    <span class="annotation">@NonNull</span>
    <span class="directive">private</span> <span class="directive">static</span> <span class="predefined-type">List</span>&lt;WordFrequency&gt; getTopFrequentWords(<span class="annotation">@NonNull</span> TweetSearchResponse response,
                                                           <span class="annotation">@NonNull</span> <span class="predefined-type">Integer</span> wordsNumber) {
        <span class="keyword">if</span> (response.getData() == <span class="predefined-constant">null</span>) {
            <span class="keyword">return</span> <span class="predefined-type">Collections</span>.emptyList();
        }

        <span class="keyword">return</span> getWordOccurrences(response).entrySet().stream()
                .sorted(<span class="predefined-type">Map</span>.Entry.comparingByValue(TwitterFrequentWordsController::compareIntegersReversed))
                .limit(wordsNumber)
                .map(v -&gt; <span class="keyword">new</span> WordFrequency(v.getKey(), v.getValue()))
                .collect(Collectors.toList()); <i class="conum" data-value="4"></i><b>(4)</b>
    }

    <span class="directive">private</span> <span class="directive">static</span> <span class="predefined-type">Integer</span> compareIntegersReversed(<span class="predefined-type">Integer</span> v1, <span class="predefined-type">Integer</span> v2) {
        <span class="keyword">return</span> v2 - v1;
    }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Create a method to calculate the number of occurrences for all the words.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Create a <code>Map</code> to store the number of occurrences.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Split the text of tweets on words (we will split by any non-alphabetic character), filter out all words shorter than four characters to remove articles and increment the counter for each word in the <code>Map</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Sort the words by the number of occurrences, limit the number by certain amount, and convert the result to a list with instances of <code>WordFrequency</code>.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="running-the-application">9. Running the Application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To run the application, use the <code>./gradlew run</code> command, which starts the application on port 8080.</p>
</div>
<div class="paragraph">
<p>You can send a few requests to the path to test the application. We will use cURL for that.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The search for <code>20</code> most frequent words in tweets about <code>"Ukraine"</code> returns words representing
relevant topics at the time (beginning of 2022):</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">curl -i 'localhost:8080/twitter-frequent-words?words-n=20&amp;search-query=Ukraine'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">[
  {<span class="key"><span class="delimiter">&quot;</span><span class="content">word</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ukraine</span><span class="delimiter">&quot;</span></span>,<span class="key"><span class="delimiter">&quot;</span><span class="content">numberOccurred</span><span class="delimiter">&quot;</span></span>: <span class="integer">40</span>}, {<span class="key"><span class="delimiter">&quot;</span><span class="content">word</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">https</span><span class="delimiter">&quot;</span></span>,    <span class="key"><span class="delimiter">&quot;</span><span class="content">numberOccurred</span><span class="delimiter">&quot;</span></span>: <span class="integer">15</span>},
  {<span class="key"><span class="delimiter">&quot;</span><span class="content">word</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">russian</span><span class="delimiter">&quot;</span></span>,<span class="key"><span class="delimiter">&quot;</span><span class="content">numberOccurred</span><span class="delimiter">&quot;</span></span>: <span class="integer">12</span>}, {<span class="key"><span class="delimiter">&quot;</span><span class="content">word</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">with</span><span class="delimiter">&quot;</span></span>,     <span class="key"><span class="delimiter">&quot;</span><span class="content">numberOccurred</span><span class="delimiter">&quot;</span></span>: <span class="integer">9</span>},
  {<span class="key"><span class="delimiter">&quot;</span><span class="content">word</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">russia</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">numberOccurred</span><span class="delimiter">&quot;</span></span>: <span class="integer">9</span>},  {<span class="key"><span class="delimiter">&quot;</span><span class="content">word</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">invasion</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">numberOccurred</span><span class="delimiter">&quot;</span></span>: <span class="integer">7</span>},
  {<span class="key"><span class="delimiter">&quot;</span><span class="content">word</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">from</span><span class="delimiter">&quot;</span></span>,   <span class="key"><span class="delimiter">&quot;</span><span class="content">numberOccurred</span><span class="delimiter">&quot;</span></span>: <span class="integer">6</span>},  {<span class="key"><span class="delimiter">&quot;</span><span class="content">word</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">india</span><span class="delimiter">&quot;</span></span>,    <span class="key"><span class="delimiter">&quot;</span><span class="content">numberOccurred</span><span class="delimiter">&quot;</span></span>: <span class="integer">5</span>},
  {<span class="key"><span class="delimiter">&quot;</span><span class="content">word</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">that</span><span class="delimiter">&quot;</span></span>,   <span class="key"><span class="delimiter">&quot;</span><span class="content">numberOccurred</span><span class="delimiter">&quot;</span></span>: <span class="integer">5</span>},  {<span class="key"><span class="delimiter">&quot;</span><span class="content">word</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">about</span><span class="delimiter">&quot;</span></span>,    <span class="key"><span class="delimiter">&quot;</span><span class="content">numberOccurred</span><span class="delimiter">&quot;</span></span>: <span class="integer">5</span>},
  {<span class="key"><span class="delimiter">&quot;</span><span class="content">word</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">border</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">numberOccurred</span><span class="delimiter">&quot;</span></span>: <span class="integer">4</span>},  {<span class="key"><span class="delimiter">&quot;</span><span class="content">word</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">army</span><span class="delimiter">&quot;</span></span>,     <span class="key"><span class="delimiter">&quot;</span><span class="content">numberOccurred</span><span class="delimiter">&quot;</span></span>: <span class="integer">4</span>},
  {<span class="key"><span class="delimiter">&quot;</span><span class="content">word</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">putin</span><span class="delimiter">&quot;</span></span>,  <span class="key"><span class="delimiter">&quot;</span><span class="content">numberOccurred</span><span class="delimiter">&quot;</span></span>: <span class="integer">4</span>},  {<span class="key"><span class="delimiter">&quot;</span><span class="content">word</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">people</span><span class="delimiter">&quot;</span></span>,   <span class="key"><span class="delimiter">&quot;</span><span class="content">numberOccurred</span><span class="delimiter">&quot;</span></span>: <span class="integer">4</span>},
  {<span class="key"><span class="delimiter">&quot;</span><span class="content">word</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">forces</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">numberOccurred</span><span class="delimiter">&quot;</span></span>: <span class="integer">4</span>},  {<span class="key"><span class="delimiter">&quot;</span><span class="content">word</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">troops</span><span class="delimiter">&quot;</span></span>,   <span class="key"><span class="delimiter">&quot;</span><span class="content">numberOccurred</span><span class="delimiter">&quot;</span></span>: <span class="integer">4</span>},
  {<span class="key"><span class="delimiter">&quot;</span><span class="content">word</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">their</span><span class="delimiter">&quot;</span></span>,  <span class="key"><span class="delimiter">&quot;</span><span class="content">numberOccurred</span><span class="delimiter">&quot;</span></span>: <span class="integer">4</span>},  {<span class="key"><span class="delimiter">&quot;</span><span class="content">word</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">will</span><span class="delimiter">&quot;</span></span>,     <span class="key"><span class="delimiter">&quot;</span><span class="content">numberOccurred</span><span class="delimiter">&quot;</span></span>: <span class="integer">4</span>},
  {<span class="key"><span class="delimiter">&quot;</span><span class="content">word</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">biden</span><span class="delimiter">&quot;</span></span>,  <span class="key"><span class="delimiter">&quot;</span><span class="content">numberOccurred</span><span class="delimiter">&quot;</span></span>: <span class="integer">4</span>},  {<span class="key"><span class="delimiter">&quot;</span><span class="content">word</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">just</span><span class="delimiter">&quot;</span></span>,     <span class="key"><span class="delimiter">&quot;</span><span class="content">numberOccurred</span><span class="delimiter">&quot;</span></span>: <span class="integer">3</span>}
]</code></pre>
</div>
</div>
</li>
<li>
<p>The results of search for <code>10</code> most common words in tweets containing the substring <code>"farm"</code> also seem to be reasonable:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">curl -i 'localhost:8081/twitter-frequent-words?words-n=10&amp;search-query=farm'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">[
  {<span class="key"><span class="delimiter">&quot;</span><span class="content">word</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">farm</span><span class="delimiter">&quot;</span></span>,      <span class="key"><span class="delimiter">&quot;</span><span class="content">numberOccurred</span><span class="delimiter">&quot;</span></span>: <span class="integer">47</span>}, {<span class="key"><span class="delimiter">&quot;</span><span class="content">word</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">workers</span><span class="delimiter">&quot;</span></span>,   <span class="key"><span class="delimiter">&quot;</span><span class="content">numberOccurred</span><span class="delimiter">&quot;</span></span>: <span class="integer">17</span>},
  {<span class="key"><span class="delimiter">&quot;</span><span class="content">word</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">https</span><span class="delimiter">&quot;</span></span>,     <span class="key"><span class="delimiter">&quot;</span><span class="content">numberOccurred</span><span class="delimiter">&quot;</span></span>: <span class="integer">16</span>}, {<span class="key"><span class="delimiter">&quot;</span><span class="content">word</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">hello</span><span class="delimiter">&quot;</span></span>,     <span class="key"><span class="delimiter">&quot;</span><span class="content">numberOccurred</span><span class="delimiter">&quot;</span></span>: <span class="integer">10</span>},
  {<span class="key"><span class="delimiter">&quot;</span><span class="content">word</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">animal</span><span class="delimiter">&quot;</span></span>,    <span class="key"><span class="delimiter">&quot;</span><span class="content">numberOccurred</span><span class="delimiter">&quot;</span></span>: <span class="integer">9</span>},  {<span class="key"><span class="delimiter">&quot;</span><span class="content">word</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">redvelvet</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">numberOccurred</span><span class="delimiter">&quot;</span></span>: <span class="integer">9</span>},
  {<span class="key"><span class="delimiter">&quot;</span><span class="content">word</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">those</span><span class="delimiter">&quot;</span></span>,     <span class="key"><span class="delimiter">&quot;</span><span class="content">numberOccurred</span><span class="delimiter">&quot;</span></span>: <span class="integer">7</span>},  {<span class="key"><span class="delimiter">&quot;</span><span class="content">word</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">their</span><span class="delimiter">&quot;</span></span>,     <span class="key"><span class="delimiter">&quot;</span><span class="content">numberOccurred</span><span class="delimiter">&quot;</span></span>: <span class="integer">7</span>},
  {<span class="key"><span class="delimiter">&quot;</span><span class="content">word</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">temporary</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">numberOccurred</span><span class="delimiter">&quot;</span></span>: <span class="integer">6</span>},  {<span class="key"><span class="delimiter">&quot;</span><span class="content">word</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">revi</span><span class="delimiter">&quot;</span></span>,      <span class="key"><span class="delimiter">&quot;</span><span class="content">numberOccurred</span><span class="delimiter">&quot;</span></span>: <span class="integer">6</span>}
]</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is also highly recommended, that you implement tests for all the controllers you write, but we will skip writing
tests for our controller in this guide.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="generate-a-micronaut-application-native-executable-with-graalvm">10. Generate a Micronaut Application Native Executable with GraalVM</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We will use <a href="https://www.graalvm.org/">GraalVM</a>, the polyglot embeddable virtual machine, to generate a native executable of our Micronaut application.</p>
</div>
<div class="paragraph">
<p>Compiling native executables ahead of time with GraalVM improves startup time and reduces the memory footprint of JVM-based applications.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Only Java and Kotlin projects support using GraalVM&#8217;s <code>native-image</code> tool. Groovy relies heavily on reflection, which is only partially supported by GraalVM.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="native-executable-generation">10.1. Native executable generation</h3>
<div class="paragraph">
<p>The easiest way to install GraalVM on Linux or Mac is to use <a href="https://sdkman.io/">SDKMan.io</a>.</p>
</div>
<div class="listingblock">
<div class="title">Java 11</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">sdk install java 22.3.r11-grl</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you still use Java 8, use the JDK11 version of GraalVM.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Java 17</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">sdk install java 22.3.r17-grl</code></pre>
</div>
</div>
<div class="paragraph">
<p>For installation on Windows, or for manual installation on Linux or Mac, see the <a href="https://www.graalvm.org/22.0/docs/getting-started/">GraalVM Getting Started</a> documentation.</p>
</div>
<div class="paragraph">
<p>After installing GraalVM, install the <code>native-image</code> component, which is not installed by default:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">gu install native-image</code></pre>
</div>
</div>
<div class="paragraph">
<p>To generate a native executable using Gradle, run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">./gradlew nativeCompile</code></pre>
</div>
</div>
<div class="paragraph">
<p>The native executable is created in <code>build/native/nativeCompile</code> directory and can be run with <code>build/native/nativeCompile/micronautguide</code>.</p>
</div>
<div class="paragraph">
<p>It is possible to customize the name of the native executable or pass additional parameters to GraalVM:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">graalvmNative {
    binaries {
        main {
            imageName.set(<span class="string"><span class="delimiter">'</span><span class="content">mn-graalvm-application</span><span class="delimiter">'</span></span>) <i class="conum" data-value="1"></i><b>(1)</b>
            buildArgs.add(<span class="string"><span class="delimiter">'</span><span class="content">--verbose</span><span class="delimiter">'</span></span>) <i class="conum" data-value="2"></i><b>(2)</b>
        }
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The native executable name will now be <code>mn-graalvm-application</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>It is possible to pass extra arguments to build the native executable</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="next-steps">11. Next Steps</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="learn-how-to-write-openapi-definition-and-generate-server-based-on-it">11.1. Learn How to Write OpenAPI Definition and Generate Server Based on It</h3>
<div class="paragraph">
<p>Read the <a href="https://guides.micronaut.io/latest/micronaut-openapi-generator-server.html">"Use OpenAPI Definition to Generate a Micronaut Server" Guide</a>
to learn how to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>understand OpenAPI definition files and write your own definition files,</p>
</li>
<li>
<p>generate server API based on the definitions,</p>
</li>
<li>
<p>implement the functionality of the server based on the API and write comprehensive tests utilizing
Micronaut`s features.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="learn-micronaut">11.2. Learn Micronaut</h3>
<div class="paragraph">
<p>To learn more about Micronaut framework and its features visit
<a href="https://micronaut.io/docs/">Micronaut documentation</a> or read one of the several
<a href="https://micronaut.io/guides/">Micronaut guides</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="micronaut-openapi">11.3. Micronaut OpenAPI</h3>
<div class="ulist">
<ul>
<li>
<p>Use <a href="https://micronaut-projects.github.io/micronaut-openapi/latest/guide">Micronaut OpenAPI</a> module to generate OpenAPI definition documents from controllers with Micronaut annotations.</p>
</li>
</ul>
</div>
</div>

            </div>
        </div>
    </div>
</main>

<footer id="footer">
    <div class="container">

        <div class="row">
            <div class="col-sm-5 footer-left">

                <div id="text-14" class="widget widget_text">
                    <div class="textwidget">
                        <p>
                            <img class="alignnone size-medium wp-image-3736" src="./images/micronaut_foundation_horizontal_white.svg" alt="Micronaut Foundation"/>
                        </p>
                    </div>
                </div>
            </div>
            <div class="col-sm-7 footer-right">

                <ul class="meta">

                    <li id="menu-item-2895" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2895">
                        <a href="https://micronaut.io/brand-guidelines/">Brand Guidelines</a>
                    </li>
                    <li id="menu-item-2894" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2894">
                        <a href="https://micronaut.io/community-guidelines/">Community Guidelines</a>
                    </li>
                    <li id="menu-item-3377" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-privacy-policy menu-item-3377">
                        <a href="https://micronaut.io/privacy-policy/">Privacy Policy</a>
                    </li>

                </ul>

                <div id="nav_menu-2" class="widget widget_nav_menu">
                    <div class="menu-links-container">
                        <ul id="menu-links" class="menu">
                            <li class="menu-item menu-item-type-custom menu-item-object-custom "><a href="https://micronautpodcast.com"><i class="fa fa-podcast"><span class="sr-only">Podcast</span></i></a></li>
                            <li class="menu-item menu-item-type-custom menu-item-object-custom "><a href="https://micronaut.io/feed/rss/"><i class="fa fa-feed"><span class="sr-only">Feed</span></i></a></li>
                            <li class="menu-item menu-item-type-custom menu-item-object-custom "><a href="mailto:info@micronaut.io"><i class="fas fa-envelope"><span class="sr-only">Mail</span></i></a></li>
                            <li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://twitter.com/micronautfw"><i class="fab fa-twitter"><span class="sr-only">Twitter</span></i></a></li>
                            <li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://matrix.to/#/#micronautfw_questions:gitter.im"><i class="fab fa-gitter"><span class="sr-only">Gitter</span></i></a></li>
                            <li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://github.com/micronaut-projects/"><i class="fab fa-github"><span class="sr-only">GitHub</span></i></a></li>
                            <li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.youtube.com/@MicronautFramework"><i class="fab fa-youtube"><span class="sr-only">YouTube</span></i></a></li>
                            <li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.linkedin.com/showcase/micronaut"><i class="fab fa-linkedin"><span class="sr-only">LinkedIn</span></i></a></li>
                            <li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.twitch.tv/micronautfw"><i class="fab fa-twitch"><span class="sr-only">Twitch</span></i></a></li>
                        </ul>
                    </div>
                </div>
                <div id="text-5" class="widget widget_text">
                    <div class="textwidget">
                        <p>
                            <small>© 2023 MICRONAUT FOUNDATION. ALL RIGHTS RESERVED</small>
                        </p>
                    </div>
                </div>

            </div>
        </div>
    </div>
</footer>
</body>
</html>
